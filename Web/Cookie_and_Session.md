# Cookie and Session

## 등장 배경
HTTP의 비연결성(Connectionless)과 무상태성(Stateless)  
HTTP 프로토콜은 모든 요청 간 의존관계가 없다. 즉 현재 접속한 사용자가 이전에 접속했던 사용자와 동일한 사람인지 알 방법이 없다.  
연결을 유지하지 않기 때문에 리소스 낭비가 적다는 장점이 있지만, 통신할 때마다 새로 연결하기 때문에 클라이언트는 매번 인증을 해야하는 단점이 존재한다.  
따라서 HTTP에서 상태를 유지하기 위한 기술로 쿠키와 세션이 등장하게 된다.  

## 쿠키
클라이언트 로컬에 저장되는 키와 값이 들어있는 파일.  
Name, Value, Expires, Domain, Path, Secure 등을 포함한다.  
클라이언트의 상태 정보를 브라우저에 저장하여 참조한다.  

## 동작 방식
1. 웹 브라우저가 서버에 요청한다.  
2. 상태를 유지하고 싶은 값을 쿠키로 생성한다.  
3. 서버가 응답할 때 HTTP 헤더(Set-Cookie)에 쿠키를 포함해 전송한다.  
4. 전달받은 쿠키는 웹 브라우저에서 관리하고 있다가, 다음 요청 때 쿠키를 HTTP 헤더에 넣어서 전송한다.  
5. 서버에서는 쿠키 정보를 읽어 상태 정보를 확인한 후 응답한다.

### 속도
- 클라이언트에 저장되어서 빠르다.

### 라이프사이클
- 만료시간에 따라 브라우저를 종료해도 계속 남아있을 수 있다.

### 예시
- 아이디, 비밀번호 저장
- 쇼핑몰 장바구니


## 세션
일정 시간동안 같은 브라우저로부터 들어오는 요청을 하나의 상태로 보고 그 상태를 유지하는 기술.  
웹 브라우저를 통해 서버에 접속한 이후부터 브라우저를 종료할 때까지 유지되는 상태.
상태 정보를 유지하는 수단으로 쿠키를 이용한다.  

### 동작 방식
1. 웹 브라우저가 서버에 요청한다.  
2. 서버가 해당 웹 브라우저(클라이언트)에 유일한 Session ID를 부여한다. 
3. 서버가 응답할 때 HTTP 헤더(Set-Cookie)에 Session ID를 포함해서 전송한다.  
4. 웹 브라우저는 이후 웹 브라우저를 닫기 전까지 다음 요청때 부여된 Session ID가 담겨있는 쿠키를 HTTP 헤더에 넣어서 전송한다.  
5. 서버는 Session ID를 확인하고, 해당 세션에 관련된 정보를 확인한 후 응답한다.

### 속도
- 저장된 정보가 서버에 있으므로 처리가 필요해 쿠키보다 느리다.

### 라이프사이클
- 만료시간을 정할 수 있지만 브라우저가 종료되면 시간에 상관없이 삭제된다.

### 예시
- 로그인 유지
